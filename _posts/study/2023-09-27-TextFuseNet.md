---
layout: single
title: "TextFuseNet: Scene Text Detection with Richer Fused Features"
permalink: /studies/paper/TextFuseNet
tags: [Paper, Vision AI]
categories:
  - 📄 paper
use_math: true
date: 2023-09-27
published: false
---
*자연 장면에서 임의 형태의 텍스트를 탐지하는 것은 매우 도전적인 작업이다. 기존의 텍스트 탐지 방법들이 제한된 특징 표현을 기반으로 텍스트를 인식하는 것과 달리, 이 연구에서는 더 풍부한 특징을 융합하여 텍스트 탐지를 수행하는 새로운 프레임워크인 TextFuseNet을 제안한다. 더 구체적으로 본 논문에서는 문자-, 단어-, 글로벌 수준의 세 가지 특징 표현에서 텍스트를 인식하고, 강력한 임의 형태 텍스트 탐지를 달성하기 위한 새로운 텍스트 표현 융합 기술을 도입한다. 제안된 TextFuseNet은 임의 형태의 텍스트를 보다 적절하게 설명하고, 거짓 긍정을 억제하며, 더 정확한 탐지 결과를 생성할 수 있다. 제안된 프레임워크는 문자 수준 주석이 없는 데이터셋에 대해서도 약한 감독으로 훈련될 수 있다. 여러 데이터셋에서의 실험 결과, 제안된 TextFuseNet은 최고의 성능을 달성했다. 구체적으로 ICDAR2013에서 94.3%, ICDAR2015에서 92.1%, Total-Text에서 87.1%, CTW-1500에서 86.6%의 F-측정값을 달성했다.*

## 📋 Table of Contents

- [1 Introduction](#1-introduction)
- [2 Related Work](#2-related-work)
- [3 Methodology](#3-methodology)
- [4 Experiments](#4-experiments)
- [5 Conclusion](#5-conclusion)

## 1 Introduction
- 텍스트의 다양한 형태, 복잡한 배경, 불규칙한 모양, 질감 간섭 등으로 텍스트 탐지에 영향을 준다.
- 기존 방법들을 문자 기반과 단어 기반 접근으로 구분된다.
- 문자 기반 방법은 텍스트를 여러 문자의 조합으로 간주하므로 문자를 추출한 다음 이를 단어로 그룹화한다. 
- 문자 기반 한계는 생성된 문자 후보가 많아서 일반적으로 시간이 많이 소요된다. 
- 단어 기반 방법은 일반 객체 탐지를 기반으로 직접 단어를 탐지하였지만, 임의의 형태 텍스트를 효과적으로 탐지하기 어렵다.
- 기존 인스턴스 세그멘테이션으로 다양한 형태의 텍스트를 탐지하였지만 Fig1 (a)와 같이 두 가지 한계가 존재한다.
  - 글로벌 컨텍스트를 고려하지 않고 단일 RoI만을 탐지하므로 부정확하다.
  - 단어 의미의 다양한 수준을 모델링하지 않아 false positive 위험이 있다.
- 본 논문에서는 임의의 형태의 텍스트를 효과적으로 검출하기 위해 **TextFuseNet**을 제안한다.
- TextFuseNet 프레임워크는 문자-, 단어-, 전역 수준 특징을 융합하여 임의의 모양의 텍스트를 탐지할 수 있도록 Mask R-CNN을 확장한다.
- 글로벌 의미론적 특징을 검출 및 마스크 분기의 검출 파이프라인에 사용한다.
- 다중 경로 특징 융합 아키텍처를 도입으로 차별화된 표현 학습이 가능하다.
- 문자 수준 레이블이 없는 경우에도 효과적인 학습을 가능하게 하는 약한 감독 학습 방식을 소개한다.
- 주요 기여도는 세가지로 요약된다.
  - (1) 텍스트 탐지를 위해 특징을 융합하는 새로운 프레임워크인 TextFuseNet을 도입한다.
  - (2) 단어 수준 주석을 활용하는 약한 감독 학습 방식을 개발한다.
  - (3) 임의의 모양을 가진 텍스트가 포함된 여러 벤치마크에서 최고 성능을 달성했다.

  <div align="center">
  <img src="../../assets/images/2023-09-27-TextFuseNet/Fig1.jpg" alt="Figure_1" style="zoom:80%;"/> 
  </div>

## 2 Related Work
- 기존 주요 방법의 카테고리는 문자 기반과 단어 기반 방법이 있다.
- **문자 기반 방법**
  - 복잡한 문자 탐지기 (예: SWT, MSER, FASText)를 사용하여 문자 후보를 추출한다.
  - 문자/비문자 분류기로 거짓 후보를 제거한다.
  - 선행 지식이나 군집/그룹화 모델에 따른 단어로의 그룹화한다.
  - 이 방식은 정교한 설계가 요구되며 여러 단계의 처리로 인한 복잡성과 오류 축적이 되고 시간 소요가 크다.
- **단어 기반 방법**
  - 일반 객체 탐지 방법에서 영감을 받아 직접 단어를 탐지한다.
  - CTPN (CNN과 RNN 사용, [Tian et al., 2016]) - 작은 텍스트 박스 연결한다.
  - TextBoxes 및 TextBoxes++ ([Liao et al., 2018a]) - 여러 텍스트 박스 레이어 추가한다.
  - SegLink ([Shi et al., 2017]) - 텍스트 세그먼트와 연결 관계를 검출한다.
  - 이 방법들은 주로 수평 또는 다양한 방향의 텍스트에 적합하다.
- 임의 형태 텍스트 탐지를 위한 **인스턴스 세그멘테이션** 기반 방법
  - CNN을 통한 텍스트/비텍스트 예측 및 링크를 예측한다.
  - SPCNet (Mask R-CNN 기반, [Xie et al., 2019]) - 텍스트 영역을 찾는다.
  - PSENet ([Wang et al., 2019a]) - 임의의 형태의 텍스트를 탐지한다.
  - 형태 인식 임베딩 학습 ([Tian et al., 2019]) - 다양한 비율의 텍스트 인스턴스에 적응적으로 수용하도록 학습하는 형태 인식 손실을 도입했다.

## 3 Methodology
### 3.1 Framework
- 다중 수준 특징 표현 추출: 특징 피라미드 네트워크(FPN) 및 리전 제안 네트워크(RPN)를 사용하여 다양한 스케일의 특징 맵과 텍스트 제안을 생성합니다.
- 글로벌 의미 활용: 새로운 의미 분할 분기를 도입하여 글로벌 수준 특징을 얻습니다.
- 단어 및 문자 탐지: 탐지 분기에서는 단어와 문자를 탐지하기 위해 단어- 및 글로벌 수준 특징을 추출하고 융합합니다.
- 인스턴스 세그멘테이션: 마스크 분기에서는 객체의 인스턴스 세그멘테이션을 수행하기 위해 문자-, 단어-, 글로벌 수준 특징을 모두 추출하고 융합합니다.
- 다중 경로 융합 아키텍처: 추출된 다양한 특징들을 융합하여 임의의 모양을 가진 텍스트를 탐지하기 위한 다중 경로 융합 아키텍처를 제안합니다.

### 3.2 Multi-level Feature Representation
- 문자 및 단어 수준 특징: 탐지 및 마스크 분기에서 제안된 영역 내의 단어와 문자를 탐지함으로써 쉽게 얻을 수 있습니다. RoIAlign을 사용하여 다양한 특징을 추출하고 단어 및 문자 탐지를 수행합니다.
- 글로벌 수준 특징 추출을 위한 새로운 네트워크: 글로벌 수준 특징을 얻기 위해 의미 분할 분기를 탐지기에 추가로 도입합니다. FPN의 출력을 기반으로 구축된 의미 분할 분기는 모든 수준의 특징을 하나의 통합된 표현으로 융합하고, 이 통합된 표현에 대해 세분화를 수행하여 글로벌하게 세분화된 텍스트 탐지 결과를 얻습니다.

### 3.3 Multi-path Fusion Architecture
- 탐지 및 마스크 분기에서의 다중 경로 융합 적용: RPN에서 얻은 텍스트 제안을 기반으로 글로벌 및 단어 수준 특징을 다른 경로에서 추출하고 이를 융합하여 단어 및 문자 형태로 텍스트 탐지를 수행합니다.
- 문자 수준 특징의 융합 불가: 탐지를 수행하기 전에 문자가 아직 인식되지 않았기 때문에 탐지 분기에서 문자 수준 특징을 추출하고 융합할 수 없습니다.
- 마스크 분기에서의 융합: 각 단어 수준 인스턴스에 대해 해당하는 문자-, 단어-, 글로벌 수준 특징을 다중 경로 융합 아키텍처 내에서 인스턴스 세그멘테이션을 위해 융합합니다.
- 다중 경로 융합 아키텍처의 구체적 설명: 다양한 경로에서 다중 수준 특징을 추출하고 이를 융합하여 더 풍부한 특징을 얻어 더 구별 가능한 표현을 학습하는 데 도움을 줍니다.
- 전체 목표 설정: 제안된 TextFuseNet의 전체 목표를 텍스트 탐지 문제 해결을 위한 손실 함수의 합으로 정식화합니다.

### 3.4 Weakly Supervised Learning
- 문자 수준 주석의 필요성: TextFuseNet은 단어와 문자 모두를 탐지하기 위해 설계되었으므로, 효과적인 훈련을 위해 문자 수준 주석이 필요합니다.
- 데이터셋의 한계: 일부 기존 데이터셋은 문자 수준 주석을 제공하지 않습니다.
- 약한 감독 학습 기반 방식 도입: 문자 주석을 직접 달기보다는, 약한 감독 학습 아이디어에 영감을 받아 TextFuseNet을 훈련시키는 약한 감독 학습 기반 방식을 제안합니다.
- 사전 훈련된 모델을 이용한 문자 수준 학습 예제 탐색: 문자- 및 단어 수준 주석이 있는 완전히 주석이 달린 데이터셋에서 제안된 프레임워크를 기반으로 사전 훈련된 모델을 사용하여 약한 감독 데이터에서 학습함으로써 문자 수준 학습 예제를 탐색합니다.
- 사전 훈련된 모델 M을 이용한 문자 후보 샘플 얻기: 데이터셋 A에 사전 훈련된 모델 M을 적용하여 문자 후보 샘플 세트를 얻습니다.
- 긍정 문자 샘플의 식별: 신뢰도 점수 임계값과 약한 감독 단어 수준 주석을 기반으로 거짓 긍정 샘플을 필터링하여 긍정 문자 샘플을 식별합니다.
- 훈련을 위한 긍정 문자 샘플 사용: 식별된 긍정 문자 샘플을 문자 수준 주석으로 사용하고, 단어 수준 주석과 결합하여 더 견고하고 정확한 텍스트 탐지 모델을 훈련합니다.

## 4 Experiments
### 4.1 Datasets
- SynthText: 800,000개의 이미지와 800만 개의 합성 단어 인스턴스를 포함한 합성 데이터셋. 단어 및 문자 수준 주석이 회전된 사각형 형태로 제공됩니다.
- ICDAR 2013: 수평 텍스트 데이터셋으로, 229개의 훈련 이미지와 233개의 테스트 이미지가 있습니다. 단어 및 문자 수준 주석을 제공합니다.
- ICDAR 2015: 다양한 방향의 텍스트를 포함한 데이터셋으로, 1000개의 훈련 이미지와 500개의 테스트 이미지를 포함합니다. 이 데이터셋은 사각형으로 라벨링된 단어 수준 주석만 제공합니다.
- Total-Text: 장면 텍스트 읽기를 위한 임의 형태 텍스트 데이터셋으로, 1255개의 훈련 이미지와 300개의 테스트 이미지가 있습니다. 모든 이미지는 단어 수준에서 다각형으로 주석이 달려 있습니다.
- CTW-1500: 임의 형태 텍스트 읽기에 초점을 맞춘 데이터셋으로, 1000개의 훈련 이미지와 500개의 테스트 이미지를 포함합니다. Total-Text와는 다르게, CTW-1500의 주석은 텍스트 라인 수준에서 다각형으로 라벨링됩니다.

### 4.2 Implementation Details
- 프레임워크 구현: Maskrcnnbenchmark를 기반으로 하며, NVidia Tesla V100 GPU를 사용한 고성능 서버에서 실험을 진행합니다.
- 훈련 과정: SynthText에서 사전 훈련, 약한 감독하에 문자 훈련 샘플 탐색, 실세계 데이터에서의 미세 조정으로 나눕니다.
- 데이터 증강: 다양한 스케일 훈련, 무작위 회전, 무작위 색상 조정 등을 포함합니다.
- 최적화: SGD를 사용하며, 가중치 감소는 0.0001, 모멘텀은 0.9로 설정하고, 배치 크기는 8입니다.
- 사전 훈련 및 미세 조정: SynthText에서 20 에폭 동안 사전 훈련을 하며, 각 데이터셋에서 20K 반복으로 미세 조정을 진행합니다.
- 추론: 테스트 이미지의 짧은 측면을 1000으로 스케일링하고, RPN에서 생성된 텍스트 제안 중 상위 1,000개를 선택합니다. Soft NMS를 사용하여 중복된 바운딩 박스를 억제합니다.

### 4.3 Ablation Study
- 기능 모듈: TextFuseNet에서는 멀티 레벨 특징 표현(MFR)과 멀티 경로 특징 융합 아키텍처(MFA) 두 가지 모듈을 도입하여 텍스트 탐지 성능을 향상시킵니다.
- 실험 결과: ICDAR 2015와 Total-Text 데이터셋에 대한 실험에서, MFR만 사용한 경우 정밀도와 재현율이 모두 크게 향상되었고, MFR과 MFA를 함께 사용했을 때는 - 기본 모델 대비 F-측정값이 각각 4.6%와 4.3% 향상되었습니다.
- 결론: 멀티 레벨 특징 표현과 멀티 경로 특징 융합은 더 풍부한 융합 특징과 더 구별 가능한 표현을 얻는 데 도움이 되어 텍스트 탐지에 유리합니다.

### 4.4 Comparisons with State-of-the-Art Methods
- 임의 형태 텍스트 탐지: CTW-1500과 Total-Text 데이터셋을 사용하여 임의 형태의 텍스트 탐지 능력을 평가했습니다. TextFuseNet은 이 두 데이터셋에서 최고의 성능을 보였으며, ResNet-50과 ResNet-101을 백본으로 사용했을 때 각각 85.4%와 86.6%의 F-측정값을 달성했습니다.
- 다중 방향 텍스트 탐지: ICDAR 2015에서 다중 방향 텍스트 탐지의 효과를 평가했습니다. TextFuseNet은 ResNet-50과 ResNet-101을 사용하여 각각 90.1%와 92.1%의 F-측정값을 달성하며 최고 성능을 보였습니다.
- 수평 텍스트 탐지: ICDAR 2013에서 수평 텍스트 탐지의 효과를 평가했습니다. TextFuseNet은 ResNet-50과 ResNet-101을 사용하여 각각 92.2%와 94.3%의 F-측정값을 달성하며 모든 이전 작업을 능가했습니다.
- 결론: ICDAR 2013, ICDAR 2015, Total-Text 및 CTW-1500 데이터셋에서 TextFuseNet은 최고 성능을 달성하며, 적절한 속도로 추론을 수행할 수 있습니다.

## 5 Conclusion
- TextFuseNet 제안: 문자-, 단어-, 글로벌 수준 특징을 탐구하여 임의 형태의 텍스트를 탐지하기 위한 새로운 프레임워크를 제안합니다.
- 특징 탐구: 다양한 수준의 특징을 완전하고 세밀하게 탐구하여 텍스트 탐지에 유리한 더 풍부한 융합 특징을 학습합니다.
- 성능: TextFuseNet은 임의 형태의 텍스트 탐지에서 최고의 성능을 달성했습니다.